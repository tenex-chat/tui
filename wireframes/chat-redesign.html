<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chat Redesign â€” No Card Styling</title>
<style>
  :root {
    --backdrop: rgb(17, 20, 24);
    --surface: rgb(27, 32, 38);
    --border: rgb(56, 63, 72);
    --text-primary: rgba(255, 255, 255, 0.92);
    --text-secondary: rgba(255, 255, 255, 0.55);
    --text-muted: rgba(255, 255, 255, 0.72);
    --agent-brand: #7c6df0;
    --status-working: #34c759;
    --status-done: #8e8e93;
    --author-blue: #5ac8fa;
    --author-orange: #ff9f0a;
    --author-pink: #ff6482;
    --author-green: #30d158;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--backdrop);
    color: var(--text-primary);
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, sans-serif;
    padding: 24px;
    user-select: text;
    -webkit-user-select: text;
  }

  .transcript {
    max-width: 720px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  .section-label {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-secondary);
    padding: 20px 0 8px 0;
    border-bottom: 1px solid var(--border);
    margin-bottom: 8px;
  }

  /* --- Message Row --- */
  .message-row {
    padding: 8px 0;
  }
  .message-row.consecutive {
    padding: 3px 0;
  }

  .message-header {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 2px;
  }

  .avatar {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 8px;
    font-weight: 700;
    color: white;
    flex-shrink: 0;
  }

  .avatar.blue { background: var(--author-blue); }
  .avatar.orange { background: var(--author-orange); }
  .avatar.pink { background: var(--author-pink); }
  .avatar.green { background: var(--author-green); }
  .avatar.brand { background: var(--agent-brand); }

  .avatar img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
  }

  .author-name {
    font-size: 13px;
    font-weight: 600;
  }
  .author-name.blue { color: var(--author-blue); }
  .author-name.orange { color: var(--author-orange); }
  .author-name.pink { color: var(--author-pink); }
  .author-name.green { color: var(--author-green); }
  .author-name.brand { color: var(--agent-brand); }

  .arrow {
    font-size: 13px;
    color: var(--text-secondary);
  }

  .recipient {
    font-size: 13px;
    font-weight: 500;
    color: var(--agent-brand);
  }

  .timestamp {
    font-size: 11px;
    color: var(--text-secondary);
  }

  /* P-tagged (completion) messages: full opacity, body size */
  .message-body.completion {
    font-size: 15px;
    line-height: 1.5;
    color: var(--text-primary);
    opacity: 1;
  }

  /* Non-p-tagged messages: muted, slightly smaller */
  .message-body.ambient {
    font-size: 13px;
    line-height: 1.45;
    color: var(--text-primary);
    opacity: 0.72;
  }

  /* --- Tool Call Row --- */
  .tool-call-row {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 2px 0;
    font-size: 12px;
    color: var(--text-secondary);
  }
  .tool-call-row .tool-icon {
    font-size: 11px;
    opacity: 0.6;
  }
  .tool-call-row .tool-name {
    font-weight: 500;
    color: var(--text-muted);
  }

  /* --- Delegation Card --- */
  .delegation-card {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px;
    background: var(--surface);
    border-radius: 10px;
    cursor: pointer;
    margin-top: 4px;
  }
  .delegation-card:hover {
    background: rgba(27, 32, 38, 0.9);
  }

  .delegation-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    font-weight: 700;
    color: white;
    flex-shrink: 0;
  }

  .delegation-content {
    flex: 1;
    min-width: 0;
  }

  .delegation-title {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .delegation-meta {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-top: 3px;
  }

  .delegation-agent {
    font-size: 11px;
    font-weight: 500;
  }

  .status-badge {
    font-size: 10px;
    font-weight: 600;
    padding: 1px 6px;
    border-radius: 4px;
    text-transform: uppercase;
    letter-spacing: 0.3px;
  }
  .status-badge.working {
    background: rgba(52, 199, 89, 0.18);
    color: var(--status-working);
  }
  .status-badge.done {
    background: rgba(142, 142, 147, 0.18);
    color: var(--status-done);
  }

  .delegation-summary {
    font-size: 11px;
    color: var(--text-secondary);
    margin-top: 2px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .chevron {
    color: var(--text-secondary);
    opacity: 0.5;
    font-size: 11px;
    flex-shrink: 0;
  }

  .note {
    font-size: 11px;
    color: var(--text-secondary);
    font-style: italic;
    padding: 6px 0;
    border-top: 1px dashed var(--border);
    margin-top: 12px;
  }
</style>
</head>
<body>

<div class="transcript">

  <!-- SECTION: P-tagged (completion) messages -->
  <div class="section-label">P-tagged messages (completions / directed) &mdash; no card, full opacity</div>

  <div class="message-row">
    <div class="message-header">
      <div class="avatar orange">C</div>
      <span class="author-name orange">Coder</span>
      <span class="arrow">-&gt;</span>
      <span class="recipient">@Orchestrator</span>
      <span class="timestamp">2m ago</span>
    </div>
    <div class="message-body completion">
      I've finished implementing the authentication middleware. The JWT validation is working correctly and all edge cases for token expiry are handled. Ready for review.
    </div>
  </div>

  <div class="message-row consecutive">
    <div class="message-body completion">
      The rate limiting is also in place &mdash; 100 requests per minute per user with a sliding window.
    </div>
  </div>

  <div class="message-row">
    <div class="message-header">
      <div class="avatar brand">O</div>
      <span class="author-name brand">Orchestrator</span>
      <span class="arrow">-&gt;</span>
      <span class="recipient">@Coder</span>
      <span class="timestamp">1m ago</span>
    </div>
    <div class="message-body completion">
      Great work. Let me delegate the test suite to the testing agent.
    </div>
  </div>

  <!-- SECTION: Non-p-tagged messages -->
  <div class="section-label">Non-p-tagged messages (ambient / system) &mdash; no card, muted 72%</div>

  <div class="message-row">
    <div class="message-header">
      <div class="avatar green">T</div>
      <span class="author-name green">Tester</span>
      <span class="timestamp">45s ago</span>
    </div>
    <div class="message-body ambient">
      Running integration test suite against staging environment. 47 tests queued.
    </div>
  </div>

  <div class="message-row consecutive">
    <div class="message-body ambient">
      All 47 tests passed. Coverage at 94.2%.
    </div>
  </div>

  <!-- SECTION: Tool call rows -->
  <div class="section-label">Tool calls &mdash; compact single-line (unchanged)</div>

  <div class="message-row">
    <div class="message-header">
      <div class="avatar orange">C</div>
      <span class="author-name orange">Coder</span>
      <span class="timestamp">3m ago</span>
    </div>
    <div class="tool-call-row">
      <span class="tool-icon">&#x1F527;</span>
      <span class="tool-name">read_file</span>
      <span>src/middleware/auth.ts</span>
    </div>
  </div>

  <div class="message-row consecutive">
    <div class="tool-call-row">
      <span class="tool-icon">&#x1F527;</span>
      <span class="tool-name">write_file</span>
      <span>src/middleware/auth.ts &mdash; 42 lines</span>
    </div>
  </div>

  <!-- SECTION: Delegation card (recipient, not sender) -->
  <div class="section-label">Delegation card &mdash; shows RECIPIENT avatar + name</div>

  <div class="delegation-card">
    <div class="delegation-avatar" style="background: var(--author-green);">T</div>
    <div class="delegation-content">
      <div class="delegation-title">Run integration tests for auth module</div>
      <div class="delegation-meta">
        <span class="delegation-agent" style="color: var(--author-green);">@Tester</span>
        <span class="status-badge working">working</span>
      </div>
      <div class="delegation-summary">Running 47 integration tests against staging...</div>
    </div>
    <span class="chevron">&rsaquo;</span>
  </div>

  <div style="height: 8px;"></div>

  <div class="delegation-card">
    <div class="delegation-avatar" style="background: var(--author-pink);">R</div>
    <div class="delegation-content">
      <div class="delegation-title">Review API documentation</div>
      <div class="delegation-meta">
        <span class="delegation-agent" style="color: var(--author-pink);">@Reviewer</span>
        <span class="status-badge done">done</span>
      </div>
      <div class="delegation-summary">Documentation updated with new endpoint descriptions</div>
    </div>
    <span class="chevron">&rsaquo;</span>
  </div>

  <!-- Notes -->
  <div class="note">
    All text is selectable. No card backgrounds or borders on any message type. P-tagged messages are full opacity at ~15px body, non-p-tagged are 72% opacity at ~13px callout.
  </div>
</div>

</body>
</html>
