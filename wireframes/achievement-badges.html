<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Daily Runtime - Achievement Badges</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Courier New', Courier, monospace;
      background-color: #1a1a2e;
      color: #e0e0e0;
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    .header {
      margin-bottom: 20px;
    }

    .title {
      font-size: 24px;
      color: #ffffff;
      margin-bottom: 10px;
    }

    .streak-banner {
      background-color: #3b82f6;
      color: #ffffff;
      padding: 10px 15px;
      font-size: 18px;
      display: inline-block;
      font-weight: bold;
    }

    .streak-banner .fire {
      margin-right: 5px;
    }

    .legend {
      margin-top: 15px;
      font-size: 12px;
      color: #a0a0a0;
    }

    .legend span {
      margin-right: 15px;
    }

    .chart {
      border: 2px solid #3b82f6;
      background-color: #0f0f1a;
      padding: 20px;
    }

    .chart-row {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      position: relative;
    }

    .chart-row:hover {
      background-color: rgba(59, 130, 246, 0.1);
    }

    .date-label {
      width: 80px;
      font-size: 12px;
      color: #a0a0a0;
      text-align: right;
      padding-right: 15px;
      flex-shrink: 0;
    }

    .bar-container {
      flex-grow: 1;
      display: flex;
      align-items: center;
      height: 35px;
      position: relative;
    }

    .bar {
      height: 25px;
      background-color: #3b82f6;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: 5px;
      cursor: pointer;
      transition: opacity 0.2s;
    }

    .bar:hover {
      opacity: 0.8;
    }

    .bar.trophy {
      background-color: #fbbf24;
    }

    .bar.double-trophy {
      background-color: #f59e0b;
    }

    .bar.fire {
      background-color: #ef4444;
    }

    .badges {
      position: absolute;
      right: -40px;
      font-size: 16px;
      white-space: nowrap;
    }

    .duration-label {
      width: 100px;
      font-size: 12px;
      color: #e0e0e0;
      padding-left: 50px;
      flex-shrink: 0;
    }

    /* Tooltip */
    .tooltip {
      position: absolute;
      background-color: #2d2d3d;
      border: 2px solid #3b82f6;
      padding: 12px 15px;
      font-size: 12px;
      color: #ffffff;
      z-index: 100;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s;
      min-width: 200px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    }

    .tooltip.visible {
      opacity: 1;
    }

    .tooltip-row {
      margin: 5px 0;
    }

    .tooltip-label {
      color: #a0a0a0;
    }

    .tooltip-value {
      color: #ffffff;
      font-weight: bold;
    }

    .tooltip-achievement {
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px solid #3b82f6;
    }

    .achievement-normal {
      color: #3b82f6;
    }

    .achievement-trophy {
      color: #fbbf24;
    }

    .achievement-double {
      color: #f59e0b;
    }

    .achievement-fire {
      color: #ef4444;
    }

    .delta-positive {
      color: #22c55e;
    }

    .delta-negative {
      color: #ef4444;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1 class="title">Daily Runtime - Achievement Badges</h1>
      <div class="streak-banner" id="streakBanner">
        <span class="fire">üî•</span>
        <span id="streakCount">3-day streak</span>
      </div>
      <div class="legend">
        <span>‚ñÆ Normal</span>
        <span>üèÜ 24h+</span>
        <span>üèÜüèÜ 48h+</span>
        <span>üî• 72h+</span>
      </div>
    </div>

    <div class="chart" id="chart">
      <!-- Chart rows will be generated by JavaScript -->
    </div>

    <div class="tooltip" id="tooltip"></div>
  </div>

  <script>
    const mockData = {
      "data": [
        {"date": "Today", "runtime_ms": 93960000, "runtime_hours": 26.1},
        {"date": "Jan 28", "runtime_ms": 43200000, "runtime_hours": 12.0},
        {"date": "Jan 27", "runtime_ms": 167640000, "runtime_hours": 46.57},
        {"date": "Jan 26", "runtime_ms": 52200000, "runtime_hours": 14.5},
        {"date": "Jan 25", "runtime_ms": 101160000, "runtime_hours": 28.1},
        {"date": "Jan 24", "runtime_ms": 95040000, "runtime_hours": 26.4},
        {"date": "Jan 23", "runtime_ms": 180000000, "runtime_hours": 50.0},
        {"date": "Jan 22", "runtime_ms": 36000000, "runtime_hours": 10.0},
        {"date": "Jan 21", "runtime_ms": 108000000, "runtime_hours": 30.0},
        {"date": "Jan 20", "runtime_ms": 57600000, "runtime_hours": 16.0},
        {"date": "Jan 19", "runtime_ms": 259200000, "runtime_hours": 72.0},
        {"date": "Jan 18", "runtime_ms": 43200000, "runtime_hours": 12.0},
        {"date": "Jan 17", "runtime_ms": 82800000, "runtime_hours": 23.0},
        {"date": "Jan 16", "runtime_ms": 21600000, "runtime_hours": 6.0}
      ]
    };

    const MAX_HOURS = 72;
    const GOAL_HOURS = 24;

    function getAchievement(hours) {
      if (hours >= 72) {
        return { level: 'fire', label: 'üî• 3x Achievement', class: 'fire' };
      } else if (hours >= 48) {
        return { level: 'double', label: 'üèÜüèÜ 48h+ Achievement', class: 'double-trophy' };
      } else if (hours >= 24) {
        return { level: 'trophy', label: 'üèÜ 24h+ Achievement', class: 'trophy' };
      }
      return { level: 'normal', label: 'Normal', class: '' };
    }

    function getBadges(hours) {
      if (hours >= 72) {
        return 'üî•';
      } else if (hours >= 48) {
        return 'üèÜüèÜ';
      } else if (hours >= 24) {
        return 'üèÜ';
      }
      return '';
    }

    function calculateStreak(data) {
      let streak = 0;
      const reversedData = [...data].reverse(); // Start from today and go back

      for (const day of reversedData) {
        if (day.runtime_hours >= 24) {
          streak++;
        } else {
          break;
        }
      }

      return streak;
    }

    function formatRuntime(hours) {
      const wholeHours = Math.floor(hours);
      const minutes = Math.round((hours - wholeHours) * 60);
      return `${wholeHours}h ${minutes}m`;
    }

    function calculateDelta(hours) {
      const delta = hours - GOAL_HOURS;
      if (delta >= 0) {
        return `+${delta.toFixed(1)}h`;
      }
      return `${delta.toFixed(1)}h`;
    }

    function renderChart() {
      const chart = document.getElementById('chart');
      const tooltip = document.getElementById('tooltip');

      // Calculate and display streak
      const streak = calculateStreak(mockData.data);
      document.getElementById('streakCount').textContent = `${streak}-day streak`;

      // Find max runtime for scaling
      const maxRuntime = Math.max(...mockData.data.map(d => d.runtime_hours), MAX_HOURS);

      mockData.data.forEach((item, index) => {
        const achievement = getAchievement(item.runtime_hours);
        const badges = getBadges(item.runtime_hours);
        const barWidth = (item.runtime_hours / maxRuntime) * 100;
        const runtimeFormatted = formatRuntime(item.runtime_hours);
        const delta = calculateDelta(item.runtime_hours);
        const deltaClass = item.runtime_hours >= GOAL_HOURS ? 'delta-positive' : 'delta-negative';

        const row = document.createElement('div');
        row.className = 'chart-row';
        row.innerHTML = `
          <div class="date-label">${item.date}</div>
          <div class="bar-container">
            <div class="bar ${achievement.class}" style="width: ${barWidth}%;"></div>
            <div class="badges">${badges}</div>
          </div>
          <div class="duration-label">${runtimeFormatted}</div>
        `;

        // Add tooltip interaction
        const barElement = row.querySelector('.bar');
        barElement.addEventListener('mouseenter', (e) => {
          const achievementClass = achievement.level === 'normal' ? 'achievement-normal' :
                                  achievement.level === 'trophy' ? 'achievement-trophy' :
                                  achievement.level === 'double' ? 'achievement-double' :
                                  'achievement-fire';

          tooltip.innerHTML = `
            <div class="tooltip-row">
              <span class="tooltip-label">Date:</span>
              <span class="tooltip-value"> ${item.date}</span>
            </div>
            <div class="tooltip-row">
              <span class="tooltip-label">Runtime:</span>
              <span class="tooltip-value"> ${runtimeFormatted}</span>
            </div>
            <div class="tooltip-row">
              <span class="tooltip-label">Delta (24h goal):</span>
              <span class="tooltip-value ${deltaClass}"> ${delta}</span>
            </div>
            <div class="tooltip-achievement">
              <div class="tooltip-row ${achievementClass}">
                <span class="tooltip-label">Achievement:</span>
                <span class="tooltip-value"> ${achievement.label}</span>
              </div>
            </div>
          `;

          tooltip.classList.add('visible');

          // Position tooltip
          const rect = row.getBoundingClientRect();
          const containerRect = chart.getBoundingClientRect();
          tooltip.style.left = `${rect.right - containerRect.left + 10}px`;
          tooltip.style.top = `${rect.top - containerRect.top}px`;
        });

        barElement.addEventListener('mouseleave', () => {
          tooltip.classList.remove('visible');
        });

        chart.appendChild(row);
      });
    }

    // Initialize chart
    renderChart();
  </script>
</body>
</html>